# 比特幣概念股股價預測分析 (LSTM 模型)

本專案旨在利用比特幣的歷史價格與網路聲量數據，來預測台灣特定比特幣概念股（以台積電 2330.TW 為例）的股價走勢。主要使用時間序列分析中的 LSTM (長短期記憶) 深度學習模型進行預測。
主要為練習使用 LSTM 模型進行時間序列預測，並非針對實際股市投資進行分析。

## 專案流程

1.  **資料收集**:
    *   使用 `yfinance` API 爬取多支台灣比特幣概念股（如：台積電、精英、華碩、技嘉等）於 2021-01-01 至 2023-12-31 期間的每日調整後收盤價 (`Adj Close`)。
    *   收集同期間的比特幣每日價格 (`Data_Bitcoin.csv`)。
    *   收集同期間的比特幣每日網路聲量數據，包含新聞聲量、新聞情緒分數、社群討論聲量等 (`Data_Bitcoin_buzz.csv`)。

2.  **資料前處理**:
    *   載入上述三種資料來源。
    *   **時間戳對齊**：由於股價資料僅存在於股市開市日，而比特幣價格與聲量為每日數據，因此進行以下處理：
        *   找出每個股市開市日 (`Trading_Date`)。
        *   對於每個開市日，計算從該日到下一個開市日前一日之間的比特幣價格與網路聲量的平均值。
        *   將此平均值作為該開市日的比特幣相關特徵值，以解決時間頻率不一致的問題。
    *   合併處理後的比特幣特徵數據與目標股票（台積電）的股價數據。
    *   使用 `MinMaxScaler` 將所有特徵與目標股價縮放到 0 到 1 之間。

3.  **探索性資料分析 (EDA)**:
    *   視覺化比較縮放後的台積電股價與比特幣新聞情緒分數隨時間變化的趨勢。

4.  **模型建立與訓練**:
    *   將時間序列資料轉換為適用於 LSTM 模型的監督式學習格式，設定時間步長 (`time_step`) 為 200 天。
    *   建立 LSTM 模型架構：
        *   輸入層
        *   LSTM 層 (50 units, return_sequences=True)
        *   LSTM 層 (50 units)
        *   Dense 層 (25 units)
        *   輸出層 (Dense, 1 unit)
    *   使用 `adam` 優化器和 `mean_squared_error` 損失函數編譯模型。
    *   將資料集劃分為訓練集與測試集 (80% 訓練, 20% 測試)。
    *   使用 `EarlyStopping` 回調函數監控驗證集損失 (`val_loss`)，在模型性能不再提升時停止訓練，以防止過度擬合。

5.  **模型評估與預測**:
    *   使用訓練完成的模型對測試集進行股價預測。
    *   計算預測結果相對於實際股價的均方根誤差 (RMSE) 作為模型性能指標。
    *   視覺化呈現訓練期間的實際股價、測試期間的實際股價以及模型在測試期間的預測股價，以直觀評估預測效果。

## 使用技術

*   **程式語言**: Python 3
*   **主要函式庫**:
    *   `pandas`: 資料處理與分析
    *   `pandas_datareader`, `yfinance`: 股價資料爬取
    *   `numpy`: 數值計算
    *   `scikit-learn`: 資料縮放 (`MinMaxScaler`), 資料集切分 (`train_test_split`)
    *   `tensorflow.keras`: LSTM 模型建立與訓練 (`Sequential`, `LSTM`, `Dense`, `EarlyStopping`)
    *   `matplotlib`: 資料視覺化

## 如何運行

1.  確保已安裝 `requirements.txt` 中列出的所有 Python 函式庫。
2.  將 `Concept Stock Price.ipynb` 與所需的 CSV 資料檔 (`Data_Bitcoin.csv`, `Data_Bitcoin_buzz.csv`, `Data_StockPrice2.csv` - 若不存在，筆記本首段會自動生成) 放置於同一目錄下。
3.  依序執行 Jupyter Notebook 中的程式碼區塊。
